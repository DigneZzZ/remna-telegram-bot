# Команды для выполнения на сервере для перезапуска бота

# 1. Перейти в директорию проекта
cd ~/remna-telegram-bot

# 2. Остановить текущий контейнер
docker-compose -f docker-compose-prod.yml down

# 3. Пересобрать контейнер с новыми изменениями (важно для применения изменений в config.py)
docker-compose -f docker-compose-prod.yml build --no-cache

# 4. Запустить контейнер заново
docker-compose -f docker-compose-prod.yml up -d

# 5. Подождать 10 секунд для запуска
sleep 10

# 6. Проверить логи с подробной информацией об авторизации
docker-compose -f docker-compose-prod.yml logs --tail=50 | grep -E "(Authorization check|ADMIN_USER_IDS|Parsed ADMIN_USER_IDS)"

# 7. Проверить статус контейнера
docker-compose -f docker-compose-prod.yml ps

# 8. Проверить переменные окружения еще раз
docker exec remnawave-admin-bot-dev env | grep -E "(API_BASE_URL|ADMIN_USER_IDS|TELEGRAM_BOT_TOKEN)"

# 9. Посмотреть последние логи в реальном времени
docker-compose -f docker-compose-prod.yml logs -f --tail=20
