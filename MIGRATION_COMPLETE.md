# üéâ –ú–ò–ì–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê: Remnawave Telegram Bot –Ω–∞ Aiogram

## üìä –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–û**: –ú–∏–≥—Ä–∞—Ü–∏—è —Å python-telegram-bot –Ω–∞ Aiogram  
‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–û**: –†–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π httpx  
‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–û**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å remnawave_api SDK  
‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–û**: –ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏  
‚úÖ **–ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**: –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã  

## üîß –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚ùå‚Üí‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: `python-telegram-bot==20.6` —Ç—Ä–µ–±–æ–≤–∞–ª `httpx~=0.25.0`, –∞ `remnawave_api` —Ç—Ä–µ–±–æ–≤–∞–ª `httpx>=0.27.2`  
**–†–µ—à–µ–Ω–∏–µ**: –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–ª–∏ –Ω–∞ `aiogram==3.20.0`, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `aiohttp` –≤–º–µ—Å—Ç–æ `httpx`

### 2. HTTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è ‚ùå‚Üí‚úÖ  
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–æ–±–ª–µ–º—ã —Å HTTP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –º–µ–∂–¥—É Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏  
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ `remnawave_api` SDK —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

### 3. Bare except statements ‚ùå‚Üí‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–Ω–æ–∂–µ—Å—Ç–≤–æ `except:` –±–ª–æ–∫–æ–≤ –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è  
**–†–µ—à–µ–Ω–∏–µ**: –í—Å–µ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ `except Exception:` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

### 4. –ü–∞–≥–∏–Ω–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚ùå‚Üí‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ 25 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–º–µ—Å—Ç–æ 200+  
**–†–µ—à–µ–Ω–∏–µ**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `size` –∏ `start`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã Aiogram
```
main_aiogram.py                    # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ Aiogram
modules/handlers_aiogram/          # –ù–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îú‚îÄ‚îÄ __init__.py                    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è
‚îú‚îÄ‚îÄ auth.py                        # –§–∏–ª—å—Ç—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ start_handler.py               # –ö–æ–º–∞–Ω–¥–∞ /start
‚îú‚îÄ‚îÄ menu_handler.py                # –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ user_handlers.py               # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–ø–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
‚îú‚îÄ‚îÄ node_handlers.py               # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ (–∑–∞–≥–ª—É—à–∫–∞)
‚îú‚îÄ‚îÄ stats_handlers.py              # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–∑–∞–≥–ª—É—à–∫–∞)
‚îú‚îÄ‚îÄ host_handlers.py               # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ö–æ—Å—Ç–∞–º–∏ (–∑–∞–≥–ª—É—à–∫–∞)
‚îú‚îÄ‚îÄ inbound_handlers.py            # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Inbounds (–∑–∞–≥–ª—É—à–∫–∞)
‚îî‚îÄ‚îÄ bulk_handlers.py               # –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–∑–∞–≥–ª—É—à–∫–∞)
```

### –¢–µ—Å—Ç–æ–≤—ã–µ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
```
test_aiogram_basic.py              # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç Aiogram
docker-compose-aiogram.yml         # Docker –¥–ª—è Aiogram –≤–µ—Ä—Å–∏–∏
MIGRATION_AIOGRAM.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏
requirements.txt                   # –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## üîÑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | python-telegram-bot | Aiogram | –°—Ç–∞—Ç—É—Å |
|-----------|-------------------|---------|---------|
| **–û—Å–Ω–æ–≤–∞** | Application | Bot + Dispatcher | ‚úÖ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ |
| **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏** | Handler –∫–ª–∞—Å—Å—ã | Router + –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã | ‚úÖ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ |
| **–°–æ—Å—Ç–æ—è–Ω–∏—è** | ConversationHandler | FSM States | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| **–§–∏–ª—å—Ç—Ä—ã** | filters.* | Filter –∫–ª–∞—Å—Å—ã | ‚úÖ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ |
| **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** | –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ | AuthFilter | ‚úÖ –£–ª—É—á—à–µ–Ω–æ |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | httpx (–∫–æ–Ω—Ñ–ª–∏–∫—Ç) | aiohttp | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –õ–æ–∫–∞–ª—å–Ω–æ
```powershell
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª (—Å–æ–∑–¥–∞–π—Ç–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ .env.example)
cp .env.example .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç–µ: TELEGRAM_BOT_TOKEN, REMNAWAVE_API_TOKEN, ADMIN_USER_IDS

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç (–±–µ–∑ API)
python3 test_aiogram_basic.py

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é
python3 main_aiogram.py
```

### Docker
```powershell
# Aiogram –≤–µ—Ä—Å–∏—è
docker-compose -f docker-compose-aiogram.yml up --build

# –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è (–¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è)
docker-compose up --build
```

## üéØ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–†–µ—à–µ–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π `remnawave_api`
2. **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - Router-based –ø–æ–¥—Ö–æ–¥ —Å FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
3. **–õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –Ω–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ async/await
4. **–ì–∏–±–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã** - —É–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
5. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –±–æ—Ç–∞

## üìã –°—Ç–∞—Ç—É—Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|----------|
| **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** | ‚úÖ –ì–æ—Ç–æ–≤–æ | AuthFilter —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π ADMIN_USER_IDS |
| **–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é** | ‚úÖ –ì–æ—Ç–æ–≤–æ | –ü–æ–∫–∞–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã |
| **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏** | ‚úÖ –ì–æ—Ç–æ–≤–æ | –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å |
| **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞–º–∏** | üîß –ó–∞–≥–ª—É—à–∫–∞ | –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞ |
| **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** | üîß –ó–∞–≥–ª—É—à–∫–∞ | –ü–æ–∫–∞–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ |
| **–•–æ—Å—Ç—ã** | üîß –ó–∞–≥–ª—É—à–∫–∞ | –ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é |
| **Inbounds** | üîß –ó–∞–≥–ª—É—à–∫–∞ | –ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é |
| **–ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** | üîß –ó–∞–≥–ª—É—à–∫–∞ | –ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é |

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ
1. ‚úÖ –ó–∞–ø—É—Å–∫ –±–∞–∑–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å `test_aiogram_basic.py`
2. ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ (1-2 –Ω–µ–¥–µ–ª–∏)
1. üîÑ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞–º–∏
2. üîÑ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ FSM —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤
3. üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º Remnawave API

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏
1. ‚è≥ –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä–æ–≥–æ `main.py`
2. ‚è≥ –£–¥–∞–ª–µ–Ω–∏–µ legacy –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
3. ‚è≥ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Aiogram —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!** 

–ì–ª–∞–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É `python-telegram-bot` –∏ `remnawave_api` - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞. –¢–µ–ø–µ—Ä—å –±–æ—Ç –º–æ–∂–µ—Ç:

- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π `remnawave_api` SDK
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å HTTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤ Docker
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–µ —Ç–æ–ª—å–∫–æ 25)
- ‚úÖ –†–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫ bare except

–ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä–µ–Ω –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.

---
*–ú–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ 27 –º–∞—è 2025 –≥.*
